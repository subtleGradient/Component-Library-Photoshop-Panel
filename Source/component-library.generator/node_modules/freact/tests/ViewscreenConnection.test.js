var ViewscreenConnection = require('../lib/ViewscreenConnection')

require('tap').test(function tap(t){
  
  t.test('exists', function tap(t){
    t.ok(ViewscreenConnection)
    t.end()
  })
  
  t.test('works', function tap(t){
    var state = {}
    ViewscreenConnection({port:8048}, state)
    t.ok(!state.isConnected)
    t.ok(state.isConnecting)
    
    t.end()
  })
  
  t.test('onError', function tap(t){
    
    var config = {port:8048}
    var state = {onError:render}
    
    var _timer
    function render(){
      ViewscreenConnection(config, state)
      console.log('render ViewscreenConnection', state)
      _timer = setTimeout(render, 50);
    }
    render()
    setTimeout(function(){ clearTimeout(_timer);t.end() }, 1000);
  })
  
  t.test('onConnect', function tap(t){
    
    var config = {port:8048}
    var state = {onConnect:render}
    
    function render(){
      ViewscreenConnection(config, state)
      console.log('render ViewscreenConnection', state)
    }
    render()
    
    t.end()
  })
  
})
